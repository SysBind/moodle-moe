<p align="center"><b>「Course Test Manager」フォーマットファイルのインポート</b></p>

<p>Course Test Managerは、Course Technology社による「開発を終了した」ソフトウェアパッケージです。 
現在は、Course Technologyによる積極的な開発は行われていません。
ExamViewと呼ばれる新しいテストマネージャーが、Course Test Managerの後を継いでいます。
しかしながら、今までCTMテストバンクからエクスポートされたフォーマットの移行手段が存在しませんでした。
これが、このモジュールが作成された理由です。</p>

<p>CTMから問題をインポートするためには、WindowsマシンにCTMをインストールして、そのマシンのMS Accessデータファイル
にアクセスする必要があります。データファイルにアクセスするために、下記の2つのファイルが必要です:</p>
<ul><li>System.mda - このファイルはCTMディレクトリのルートディレクトリにあり、MS Accessより「システムデータベース」として認識されます。</li>
<li>ctm.mdb - これはテストバンク問題を含んでいるデータベースです。CTMにインストールされたそれぞれのコースには、1つのctm.mdbデータベース
が作成されます。ctm.mdbはCTMインストールディレクトリの下位ディレクトリに保存されます。</li>
</ul>

</p>重要な処理は、あなたがmoodleをWindowsで動作しているか、Linuxで動作しているかによって幾分異なります。
どのようなプラットフォームでmoodleを動かしていても、Accessデータベースからテストバンクをインポートするために、
同一ネットワーク内にWindowsシステム(Windows 2000 または Windows XP)を置く必要があります。</p>

<p>処理方法は、<b>Windowsベース</b>のmoodleシステムの方が幾分簡単です。CTMインポートクラスを使用するために必要なことは:</p>

<ol><li>ファイルマネージャーを使って、system.mdaシステムデータベースをmoodleにアップロードしてください。
どのコースに、system.mdaをアップロードしてもかまいません。Moodleが自動的にインポート先を判断します。</li>
<li>小テストを作成して、「ファイルから小テストをインポートする」の画面に進んでください。選択したctm.mdb
データベースをインポートファイルとしてアップロードしてください。アップロードが正常にできない場合、次の画面で
データベースからインポートするための、問題のサブカテゴリを選択することができます。 このステップがある理由は、
CTMテストバンクがしばしば、本の章またはコースのセクションのようにカテゴリ分けされた大量の問題を含んでいることが
あるからです。</li></ol>

<p><b>Linuxベース</b>のmoodleシステムでは、<a href="http://odbcsock.sourceforge.net/" target="_new"><b>ODBCソケットサーバ</b></a>
と呼ばれるサードパーティのソフトウェアコンポーネントが必要です。LinuxにCTMデータベースをインポートするには、最初にこの小さな
ネットワークプログラムを、CTMデータベースを入れているWindowsシステムにダウンロードしてインストールする必要があります。
ODBCソケットサーバのインストール手順に<b>従わないで</b>ください。それらは、必要以上に更に複雑になっています! 
代わりに、下記の手順に従って、あなたのWindowsシステムにこのプログラムをインストールしてください:</p>

<ol><li>Windowsシステムに移って、<a href="http://odbcsock.sourceforge.net/" target="_new">
このサイト</a>よりダウンロードしたファイルをunzipしてください。</li>
<li>Copy the binary ODBCSocketServer.exeバイナリを、システムディレクトリ(恐らく C:\WINNT\ または C:\Windows)
または、Program Filesディレクトリ等の、削除することの無い場所にコピーしてください。</li> 

<li>次のコマンドを使って、ODBCソケットサーバをサービスとしてインストールしてください:<br />
<b>&lt;path you copied the file to in the step above&gt;ODBCSocketServer.exe /Service</b><br />
このコマンドは、スタート-&gt;ファイル名を... 画面、またはコマンドプロンプトから実行することができます。</li>

<li>スタート-&gt;設定-&gt;コントロールパネル-&gt;管理ツール-&gt;サービスを選択するか、<b>マイ コンピュータ</b>を右クリックして、
<b>管理</b>を選択、次に<b>サービスとアプリケーション-&gt;サービス</b>を選択して右側のパネルにてサービスマネージャーを開いてください。
または、スタート-&gt;ファイル名を... 画面で<b>services.msc</b>と入力することで、サービスマネージャーを開くことができます。</li>

<li>In the Service manager, right-click the ODBC Socket Server item and choose the <b>Start</b> item.  It's status 
should change to "started" when you do this. Note that you may stop and/or disable this service completely after
you've completed the import process.</li>

<li>Make sure that the system.mda and ctm.mdb access data files are on the machine, 
and that the MS Access ODBC driver is present.  It is installed in a standard Windows installation.  You can
determine if it installed by opening the "Data Sources" item in "Administrative Tools" and referring to the "Drivers"
tab.  You're going to have to determine where CTM is installed and locate the system.mda file and the ctm.mdb database 
or databases you're interested in importing data from.  Make note of the full local paths to these files as well 
as the IP address or hostname of the Windows server.  You're going to need this information for the import process.</li>

<li>Now you may import the testbank or testbanks into moodle. Crete your quiz and go into the 
"import questions from file" process.  <b>NOW HERE'S WHERE THINGS ARE DIFFERENT FOR LINUX - </b>
YOU MUST SPECIFY A DUMMY FILE IN THE UPLOAD FIELD TO GET THE IMPORT PROCESS STARTED.  THIS FILE <b>WILL NOT</b>
BE PROCESSED, IT'S JUST A PLACEHOLDER FOR THE IMPORT FORM.  YOU WILL GET A PLACE TO SPECIFY THE WINDOWS SERVER
INFORMATION NEXT.  Next, you will get a screen where you can type in the hostname for the Windows ODBC Socket Server
machine as well as the paths to the system and testbank databases.  Type in the information you wrote down from the 
previous step here and click "Connect to Server". If everything was set up correctly, you'll get another form to allow
you to choose the sub-category of questions to import from the database. The reason this step is here is that 
CTM test banks often contain a large number of categorized questions, based on the chapters of the book or 
sections of the course.  IF YOU GET TO THIS STEP WITHOUT ERROR MESSAGES, YOU HAVE SET UP THE SOCKET SERVER CORRECTLY
AND YOU'RE ABOUT TO IMPORT QUESTIONS TO MOODLE!</li>
</ol>

<p>If you received error messages during this process, you may find this technical information useful. 
The ODBC Socket server uses port 9628 to open a socket and trade and XML query for an XML result table of 
the query results.  The import class parses that XML and use it just like I use a local query to do the importing. 
</p>